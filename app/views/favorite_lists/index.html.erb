<h1>Mes Listes de Favoris</h1>


<div class="row" data-controller="favorite-list-toggle">
  <% @favorite_lists.each do |favorite_list| %>
    <div class="col-md-4 mb-4">
      <div class="card-favorite-list-collapsed" data-favorite-list-toggle-target="favoriteList" data-action="click->favorite-list-toggle#toggleCard">
        <div class="card-favorite-list">
          <div class="d-flex justify-content-between align-items-center">
            <% if favorite_list.favorites.any? %>
              <% random_favorite = favorite_list.favorites.sample %>
              <%= image_tag random_favorite.meal.photo, class: 'random-favorite-image' %>
            <% end %>
            <h5 class="card-favorite-title"><%= favorite_list.title %></h5>
            <%= button_to favorite_list_path(favorite_list), method: :delete, class: 'btn btn-delete-list' do %>
            X
            <% end %>
          </div>
          <div class="d-none" data-favorite-list-toggle-target="toggleable">
            <p class="card-text"><strong>Localisation:</strong> <%= favorite_list.localisation %></p>
            <% if favorite_list.favorites.any? %>
              <h6 class="card-subtitle mb-2 text-muted">Plats dans cette liste :</h6>
                <ul class="list-group">
                  <% favorite_list.favorites.each do |favorite| %>
                    <li class="container-favorites-index">
                            <%= link_to meal_path(favorite.meal), class: "card-meal-favorite card-bg-image", style: "background-image: url(#{favorite.meal.photo})" do %>
                              <div class="card-content">
                                <h2 class="title-meal-card"><%= favorite.meal.name %></h2>
                              </div>
                            <% end %>
                      <%= button_to favorite_list_favorite_path(favorite_list, favorite), method: :delete, turbo: false, class: 'btn btn-danger btn-delete' do %>
                        X
                      <% end %>
                    </li>
                  <% end %>
                </ul>
            <% else %>
              <p class="card-text">Votre liste est vide!</p>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <div class="button-back-size">
    <%= link_to 'CrÃ©er', new_favorite_list_path, class: 'button-back' %>
  </div>

</div>
